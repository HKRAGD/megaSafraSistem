# IMPLEMENTA√á√ÉO: CADASTRO EM LOTE DE PRODUTOS

## üìã VIS√ÉO GERAL

### Objetivo
Implementar funcionalidade para cadastro de m√∫ltiplos produtos simultaneamente, mantendo um cliente comum para todo o lote, e exibi√ß√£o agrupada na p√°gina de aloca√ß√£o de produtos.

### Decis√£o T√©cnica
Abordagem simplificada usando campo `batchId` no modelo `Product` existente, evitando over-engineering e mantendo total compatibilidade com funcionalidades atuais.

---

## üîÑ REGRAS DE IMPLEMENTA√á√ÉO

### ‚ö†Ô∏è REGRAS OBRIGAT√ìRIAS

1. **SEMPRE consultar Zen antes de implementa√ß√µes complexas:**
   - Use `mcp__zen__refactor` antes de modificar arquivos existentes
   - Use `mcp__zen__codereview` ap√≥s cada implementa√ß√£o

2. **JAMAIS quebrar funcionalidades existentes:**
   - Todos os endpoints atuais devem continuar funcionando
   - Formul√°rio individual de produto deve permanecer intacto
   - P√°gina de aloca√ß√£o atual deve funcionar normalmente

3. **Valida√ß√£o obrigat√≥ria:**
   - Todo c√≥digo deve ser validado pelo Zen
   - Testes de regress√£o antes de finalizar
   - Verificar performance das queries

4. **Compatibilidade:**
   - Produtos existentes (`batchId: null`) tratados como individuais
   - Novos campos sempre opcionais
   - APIs mant√™m retrocompatibilidade

---

## üìä CHECKLIST DE PROGRESSO

### FASE 1: BACKEND - MODELO E API ‚úÖ **COMPLETA**
- [x] **1.1 Modelo Product**
  - [x] Adicionar campo `batchId: String` (opcional, indexado)
  - [x] Adicionar √≠ndice `{ batchId: 1, status: 1 }`
  - [x] ‚úÖ **ZEN**: Usar `refactor` antes de modificar
  - [x] ‚úÖ **ZEN**: Usar `codereview` ap√≥s implementa√ß√£o

- [x] **1.2 API Cadastro em Lote**
  - [x] Criar endpoint `POST /api/products/batch`
  - [x] Valida√ß√£o at√¥mica de array de produtos
  - [x] Gera√ß√£o de UUID √∫nico para batchId
  - [x] Transa√ß√£o para criar todos os produtos
  - [x] ‚úÖ **ZEN**: Usar `refactor` para planejar estrutura
  - [x] ‚úÖ **ZEN**: Usar `codereview` ap√≥s implementa√ß√£o

- [x] **1.3 API Listagem Agrupada**
  - [x] Criar `GET /api/products/pending-allocation-grouped`
  - [x] Agrupar por batchId quando n√£o nulo
  - [x] Retornar estrutura com batches e produtos
  - [x] ‚úÖ **ZEN**: Usar `codereview` ap√≥s implementa√ß√£o

### FASE 2: FRONTEND - FORMUL√ÅRIO ‚è≥
- [x] **2.1 Componente BatchProductForm**
  - [x] Array din√¢mico de produtos
  - [x] Bot√µes adicionar/remover produtos
  - [x] Sele√ß√£o de cliente no final
  - [x] Valida√ß√£o individual por produto
  - [x] ‚úÖ **ZEN**: Usar `refactor` para planejar componente
  - [x] ‚úÖ **ZEN**: Usar `codereview` ap√≥s implementa√ß√£o

- [x] **2.2 Atualiza√ß√£o NewProductPage**
  - [x] Toggle "Individual" vs "Lote"
  - [x] Renderiza√ß√£o condicional de formul√°rios
  - [x] Manter formul√°rio individual intacto
  - [x] ‚úÖ **ZEN**: Usar `codereview` ap√≥s modifica√ß√£o

- [x] **2.3 Hook useBatchProducts** ‚úÖ **IMPLEMENTADO**
  - [x] Estado do array de produtos
  - [x] Fun√ß√µes adicionar/remover
  - [x] Valida√ß√£o do lote completo
  - [x] Submiss√£o para API
  - [x] ‚úÖ **ZEN**: `codereview` REALIZADO + corre√ß√µes aplicadas

### FASE 3: FRONTEND - ALOCA√á√ÉO ‚úÖ **COMPLETA**
- [x] **3.1 Componente ProductBatchCard**
  - [x] Card expans√≠vel por grupo
  - [x] Exibir cliente e contagem
  - [x] Lista produtos com status
  - [x] Aloca√ß√£o individual por produto
  - [x] ‚úÖ **ZEN**: Usar `refactor` para planejar componente
  - [x] ‚úÖ **ZEN**: Usar `codereview` ap√≥s implementa√ß√£o

- [x] **3.2 Atualiza√ß√£o ProductAllocationPage**
  - [x] Renderizar grupos de produtos
  - [x] Manter aloca√ß√£o individual
  - [x] Atualizar estado ap√≥s aloca√ß√µes
  - [x] Remover grupo quando vazio
  - [x] ‚úÖ **ZEN**: Usar `codereview` ap√≥s modifica√ß√£o

- [x] **3.3 Hook useProductBatches**
  - [x] Buscar produtos agrupados
  - [x] Gerenciar estado dos grupos
  - [x] Refresh autom√°tico
  - [x] ‚úÖ **ZEN**: Usar `codereview` ap√≥s implementa√ß√£o

### FASE 4: VALIDA√á√ïES E TESTES ‚ùå **CR√çTICA PENDENTE**
- [ ] **4.1 Valida√ß√µes Backend** ‚ö†Ô∏è **PARCIAL**
  - [x] M√°ximo 50 produtos por lote
  - [x] Cliente obrigat√≥rio para lotes
  - [x] Valida√ß√£o at√¥mica
  - [ ] ‚ö†Ô∏è **PENDENTE**: Tratamento de erros espec√≠ficos (AppError)

- [ ] **4.2 Valida√ß√µes Frontend** ‚ùå **CR√çTICO PENDENTE**
  - [ ] M√≠nimo 1 produto no lote
  - [ ] Valida√ß√£o tempo real
  - [ ] Feedback visual claro
  - [ ] Preven√ß√£o submiss√£o inv√°lida

- [ ] **4.3 Testes** ‚ùå **CR√çTICO PENDENTE**
  - [ ] Testes unit√°rios endpoint batch
  - [ ] Testes integra√ß√£o fluxo completo
  - [ ] Testes E2E interface
  - [ ] ‚ö†Ô∏è **CR√çTICO**: Testes regress√£o funcionalidades existentes

---

## üö® PLANO DE A√á√ÉO PRIORIT√ÅRIO

### Data: 29/06/2024 - AN√ÅLISE ZEN COMPLETADA ‚ö†Ô∏è

#### üìä **STATUS REAL IDENTIFICADO:**

**Inconsist√™ncias Cr√≠ticas Encontradas:**
- ‚ùå **Fase 2**: Marcada como "COMPLETA" mas hook `useBatchProducts` n√£o implementado
- ‚ùå **Fase 4**: Completamente pendente (0% de execu√ß√£o)
- ‚ö†Ô∏è **Status Real**: 70% do projeto conclu√≠do (n√£o 85% como relatado)

#### üéØ **PRIORIDADES CR√çTICAS (EM ORDEM):**

**1. CR√çTICO: Implementar useBatchProducts Hook**
- ‚ö†Ô∏è **Bloqueador**: Sem este hook, formul√°rio de lote n√£o funciona
- üìã **Tarefas**: Estado array, fun√ß√µes add/remove, valida√ß√£o, submiss√£o API
- ‚è±Ô∏è **Estimativa**: 4-6 horas
- üîß **Pr√≥ximo Passo**: Usar `mcp__zen__refactor` para planejar estrutura

**2. CR√çTICO: Valida√ß√µes Frontend M√≠nimas**
- ‚ö†Ô∏è **Bloqueador**: UX ruim sem valida√ß√µes em tempo real
- üìã **Tarefas**: M√≠nimo 1 produto, feedback visual, preven√ß√£o submiss√£o inv√°lida
- ‚è±Ô∏è **Estimativa**: 2-3 horas
- üîß **Integra√ß√£o**: Com useBatchProducts hook

**3. CR√çTICO: Testes de Regress√£o**
- ‚ö†Ô∏è **Risco Alto**: Funcionalidades existentes podem estar quebradas
- üìã **Tarefas**: Suite completa testando fluxos originais
- ‚è±Ô∏è **Estimativa**: 6-8 horas
- üîß **Obrigat√≥rio**: Antes de considerar projeto "conclu√≠do"

**4. IMPORTANTE: Testes da Nova Funcionalidade**
- üìã **Tarefas**: Unit tests backend, E2E lote completo
- ‚è±Ô∏è **Estimativa**: 4-6 horas
- üîß **Sequencial**: Ap√≥s itens 1-3

#### üìã **CHECKLIST IMEDIATO:**

```
[x] 1. Corrigir status no planejamento (FEITO ‚úÖ)
[x] 2. Implementar useBatchProducts hook (FEITO ‚úÖ)
[ ] 3. Implementar valida√ß√µes frontend b√°sicas
[ ] 4. Desenvolver testes de regress√£o
[ ] 5. Desenvolver testes unit√°rios/E2E novos
[ ] 6. AppError espec√≠ficos backend (melhoria)
```

#### üéØ **CRIT√âRIO DE CONCLUS√ÉO:**
- ‚úÖ Hook useBatchProducts funcionando 100%
- ‚úÖ Formul√°rio lote operacional com valida√ß√µes
- ‚úÖ Testes regress√£o 100% passando
- ‚úÖ Testes novos cobrindo funcionalidade lote
- ‚úÖ Zero quebras de funcionalidades existentes

#### ‚è∞ **TEMPO ESTIMADO RESTANTE:** 16-23 horas (2-3 dias)

---

## üèóÔ∏è ESTRUTURA T√âCNICA

### Modelo Product (Modifica√ß√£o)
```javascript
{
  // Campos existentes (mantidos)
  name, lot, seedTypeId, quantity, storageType,
  weightPerUnit, totalWeight, locationId, clientId,
  status, entryDate, expirationDate, notes, version,
  
  // NOVO CAMPO
  batchId: {
    type: String,
    required: false,
    index: true
  }
}

// NOVO √çNDICE
{ batchId: 1, status: 1 }
```

### API Response Agrupada
```javascript
{
  batches: [
    {
      batchId: "uuid-123" | null,
      clientId: "client-id",
      clientName: "Nome Cliente",
      productCount: 3,
      createdAt: "2024-01-01T00:00:00Z",
      products: [
        { id, name, lot, status, locationId, ... }
      ]
    }
  ]
}
```

### Endpoint Cadastro Lote
```javascript
// POST /api/products/batch
{
  clientId: "client-id-required",
  products: [
    {
      name: "Produto 1",
      lot: "L001",
      seedTypeId: "seed-id",
      quantity: 10,
      storageType: "saco",
      weightPerUnit: 25,
      expirationDate: "2024-12-31"
    }
    // ... mais produtos
  ]
}
```

---

## üîç PONTOS DE ATEN√á√ÉO

### Performance
- √çndice adequado para queries de agrupamento
- Limite m√°ximo de produtos por lote (50)
- Transa√ß√µes at√¥micas para consist√™ncia

### Compatibilidade
- Produtos existentes tratados automaticamente
- APIs antigas mant√™m funcionamento
- Formul√°rio individual preservado

### Seguran√ßa
- Valida√ß√£o de permiss√µes (apenas ADMIN)
- Sanitiza√ß√£o de dados de entrada
- Preven√ß√£o de SQL injection

### UX/UI
- Feedback visual claro em cada etapa
- Loading states apropriados
- Mensagens de erro espec√≠ficas
- Transi√ß√µes suaves entre estados

---

## üöÄ CRONOGRAMA

| Fase | Dura√ß√£o | Status |
|------|---------|--------|
| 1. Backend | 2-3 dias | ‚úÖ **COMPLETO** |
| 2. Frontend Cadastro | 3-4 dias | ‚úÖ **COMPLETO** |
| 3. Frontend Aloca√ß√£o | 2-3 dias | ‚úÖ **COMPLETO** |
| 4. Testes e Valida√ß√£o | 1-2 dias | ‚ùå **PENDENTE** |
| **TOTAL** | **8-12 dias** | ‚ö†Ô∏è **75% Completo** |

---

## üìù LOG DE IMPLEMENTA√á√ÉO

### Data: 28/06/2024 - FASE 1 BACKEND COMPLETA ‚úÖ

#### üéØ **IMPLEMENTA√á√ïES REALIZADAS:**

**1.1 Modelo Product Atualizado**
- ‚úÖ Campo `batchId: String` (opcional) adicionado
- ‚úÖ √çndice composto `{ batchId: 1, status: 1 }` criado para performance
- ‚úÖ Corre√ß√£o de √≠ndice redundante (conforme sugest√£o Zen)
- ‚úÖ 100% compatibilidade com produtos existentes mantida

**1.2 API Cadastro em Lote**
- ‚úÖ Endpoint `POST /api/products/batch` implementado
- ‚úÖ Valida√ß√µes: clientId obrigat√≥rio, max 50 produtos, array n√£o vazio
- ‚úÖ UUID √∫nico gerado para batchId
- ‚úÖ Transa√ß√£o MongoDB para atomicidade
- ‚úÖ Permiss√µes: apenas ADMIN pode criar lotes

**1.3 API Listagem Agrupada** 
- ‚úÖ Endpoint `GET /api/products/pending-allocation-grouped` implementado
- ‚úÖ Aggregation pipeline para agrupar por batchId
- ‚úÖ Produtos individuais (batchId: null) aparecem como grupos √∫nicos
- ‚úÖ Retorna estrutura: `{ batches: [{ batchId, clientName, products: [...] }] }`

**1.4 Estrutura de Arquivos**
```
backend/src/
‚îú‚îÄ‚îÄ models/Product.js          ‚úÖ Campo batchId + √≠ndice
‚îú‚îÄ‚îÄ controllers/productController.js  ‚úÖ 2 novos endpoints  
‚îú‚îÄ‚îÄ services/productService.js        ‚úÖ 2 novos m√©todos
‚îî‚îÄ‚îÄ routes/products.js         ‚úÖ 2 novas rotas
```

#### üîß **MELHORIAS APLICADAS (Sugest√µes Zen):**
- ‚úÖ Import Movement movido para topo (evita circular dependency)
- ‚úÖ Constante MAX_PRODUCTS_PER_BATCH = 50 (remove magic number)
- ‚úÖ Valida√ß√µes redundantes removidas do service
- ‚úÖ Transa√ß√µes MongoDB implementadas corretamente

#### üöÄ **PR√ìXIMOS PASSOS:**
- Implementar frontend para cadastro em lote
- Atualizar p√°gina de aloca√ß√£o para mostrar grupos
- Testes E2E da funcionalidade completa

#### üì° **APIS IMPLEMENTADAS:**

**1. Cadastro em Lote**
```http
POST /api/products/batch
Authorization: Bearer <token> (ADMIN only)
Content-Type: application/json

{
  "clientId": "client-uuid-123",
  "products": [
    {
      "name": "Soja Variedade A",
      "lot": "L001", 
      "seedTypeId": "seed-type-uuid",
      "quantity": 10,
      "storageType": "saco",
      "weightPerUnit": 25,
      "expirationDate": "2024-12-31"
    },
    {
      "name": "Soja Variedade B", 
      "lot": "L002",
      "seedTypeId": "seed-type-uuid",
      "quantity": 15,
      "storageType": "bag",
      "weightPerUnit": 30,
      "expirationDate": "2024-11-30"
    }
  ]
}

Response 201:
{
  "success": true,
  "message": "Lote de produtos (ID: uuid-456) cadastrado com sucesso.",
  "data": {
    "batchId": "uuid-456",
    "clientId": "client-uuid-123",
    "productsCreated": [array de produtos criados],
    "count": 2
  }
}
```

**2. Listagem Agrupada**
```http
GET /api/products/pending-allocation-grouped
Authorization: Bearer <token> (OPERATOR only)

Response 200:
{
  "success": true,
  "data": {
    "batches": [
      {
        "batchId": "uuid-456",
        "clientId": "client-uuid-123", 
        "clientName": "Fazenda ABC",
        "productCount": 2,
        "createdAt": "2024-06-28T10:00:00Z",
        "products": [
          {
            "id": "product-uuid-1",
            "name": "Soja Variedade A",
            "lot": "L001",
            "status": "AGUARDANDO_LOCACAO",
            "quantity": 10,
            "totalWeight": 250,
            "seedTypeId": { "name": "Soja Premium" },
            ...
          }
        ]
      },
      {
        "batchId": null,  // Produto individual
        "clientId": "client-uuid-789",
        "clientName": "Fazenda XYZ", 
        "productCount": 1,
        "createdAt": "2024-06-27T15:30:00Z",
        "products": [...]
      }
    ]
  }
}
```

#### ‚ö†Ô∏è **NOTAS IMPORTANTES:**

**Compatibilidade Total**
- ‚úÖ Produtos existentes continuam funcionando (batchId ser√° null)
- ‚úÖ APIs antigas mant√™m funcionalidade inalterada
- ‚úÖ Frontend atual n√£o ser√° impactado

**Performance**
- ‚úÖ √çndice composto garante queries r√°pidas para agrupamento
- ‚úÖ Transa√ß√µes at√¥micas sem impacto na performance
- ‚úÖ Aggregation pipeline otimizada

**Seguran√ßa** 
- ‚úÖ Valida√ß√µes robustas backend (clientId obrigat√≥rio, max 50 produtos)
- ‚úÖ Permiss√µes adequadas (ADMIN para cadastro, OPERATOR para listagem)
- ‚úÖ Sanitiza√ß√£o de dados de entrada

**Pr√≥ximas Melhorias (Sugest√µes Zen):**
- üîÑ Implementar AppError espec√≠ficos no service para melhor tratamento de erros
- üîÑ Considerar virtualiza√ß√£o UI para lotes muito grandes (futuro)
- üîÑ Endpoint confirmProductWithdrawal pendente (n√£o relacionado ao lote)

---

### Data: 28/06/2024 - FASE 3 FRONTEND ALOCA√á√ÉO COMPLETA ‚úÖ

#### üéØ **IMPLEMENTA√á√ïES REALIZADAS:**

**3.1 Componente ProductBatchCard**
- ‚úÖ Card expans√≠vel que exibe grupos de produtos (lotes e individuais)
- ‚úÖ Indicadores visuais de urg√™ncia (produtos com validade pr√≥xima)
- ‚úÖ Estat√≠sticas resumidas: quantidade de produtos, peso total, data de cria√ß√£o
- ‚úÖ A√ß√µes individuais de aloca√ß√£o por produto dentro do grupo
- ‚úÖ Design responsivo com Material-UI optimizado
- ‚úÖ Compatibilidade total com produtos individuais (batchId: null)

**3.2 Hook useProductBatches**
- ‚úÖ Busca dados do endpoint `/api/products/pending-allocation-grouped`
- ‚úÖ Gerenciamento inteligente de estado (loading, error, dados)
- ‚úÖ Estat√≠sticas calculadas: total de produtos, lotes, lotes urgentes
- ‚úÖ Fun√ß√µes de refresh manual e autom√°tico
- ‚úÖ Tratamento robusto de erros com feedback para usu√°rio

**3.3 Atualiza√ß√£o ProductAllocationPage**
- ‚úÖ Toggle entre visualiza√ß√£o "Agrupada" e "Individual"
- ‚úÖ Integra√ß√£o completa com ProductBatchCard
- ‚úÖ Preserva√ß√£o total da funcionalidade individual existente
- ‚úÖ Indicadores de produtos urgentes na interface
- ‚úÖ Atualiza√ß√£o autom√°tica ap√≥s aloca√ß√µes
- ‚úÖ Bot√µes de refresh inteligentes por modo de visualiza√ß√£o

**3.4 Estrutura de Arquivos Criados**
```
frontend/src/
‚îú‚îÄ‚îÄ components/products/ProductBatchCard/
‚îÇ   ‚îî‚îÄ‚îÄ index.tsx                    ‚úÖ Componente principal
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îî‚îÄ‚îÄ useProductBatches.ts         ‚úÖ Hook para gerenciamento de grupos
‚îî‚îÄ‚îÄ pages/ProductAllocation/
    ‚îî‚îÄ‚îÄ ProductAllocationPage.tsx    ‚úÖ P√°gina atualizada
```

#### üîß **FUNCIONALIDADES IMPLEMENTADAS:**

**Interface de Aloca√ß√£o Dual**
- ‚úÖ Modo "Agrupado": Exibe produtos em lotes com cards expans√≠veis
- ‚úÖ Modo "Individual": Mant√©m a visualiza√ß√£o grid tradicional
- ‚úÖ Toggle instant√¢neo entre modos sem perda de estado
- ‚úÖ Estat√≠sticas espec√≠ficas para cada modo

**ProductBatchCard Features**
- ‚úÖ Resumo visual do lote: produtos, peso, cliente, data
- ‚úÖ Expans√£o para mostrar produtos individuais
- ‚úÖ Badges de alerta para produtos com validade pr√≥xima
- ‚úÖ Bot√µes de aloca√ß√£o individual para cada produto
- ‚úÖ Design adaptativo para lotes de tamanhos diferentes

**Gerenciamento de Estado Avan√ßado**
- ‚úÖ Cache otimizado para ambos os modos de visualiza√ß√£o
- ‚úÖ Refresh seletivo ap√≥s opera√ß√µes de aloca√ß√£o
- ‚úÖ Tratamento unificado de erros entre modos
- ‚úÖ Loading states espec√≠ficos por contexto

#### üé® **MELHORIAS DE UX/UI:**

**Indicadores Visuais**
- ‚úÖ Cores diferenciadas para lotes vs produtos individuais
- ‚úÖ Badges de urg√™ncia para produtos pr√≥ximos do vencimento
- ‚úÖ Contadores din√¢micos por categoria
- ‚úÖ Transi√ß√µes suaves entre estados

**Responsividade**
- ‚úÖ Layout adaptativo para desktop, tablet e mobile
- ‚úÖ Cards flex√≠veis que se ajustam ao conte√∫do
- ‚úÖ Grid responsivo mantido no modo individual
- ‚úÖ Bot√µes e a√ß√µes otimizados para touch

#### üì± **COMPATIBILIDADE E PERFORMANCE:**

**Retrocompatibilidade**
- ‚úÖ 100% compat√≠vel com produtos existentes
- ‚úÖ Fluxo original de aloca√ß√£o individual preservado
- ‚úÖ Nenhuma quebra de funcionalidade existente
- ‚úÖ APIs antigas continuam funcionando

**Performance**
- ‚úÖ Componentes otimizados com React.memo
- ‚úÖ Estados calculados com useMemo
- ‚úÖ Fetch seletivo baseado no modo de visualiza√ß√£o
- ‚úÖ Refresh inteligente apenas dos dados necess√°rios

#### üîÑ **FLUXO DE USU√ÅRIO ATUALIZADO:**

**Operador - Modo Agrupado (Novo)**
1. Acessa p√°gina de aloca√ß√£o ‚Üí v√™ produtos agrupados por lote
2. Visualiza estat√≠sticas de urg√™ncia e resumos
3. Expande um lote espec√≠fico ‚Üí v√™ produtos individuais
4. Clica "Alocar" em produto espec√≠fico ‚Üí abre di√°logo de loca√ß√£o
5. Seleciona localiza√ß√£o ‚Üí confirma aloca√ß√£o
6. Sistema atualiza automaticamente o grupo

**Operador - Modo Individual (Preservado)**
1. Alterna para modo "Individual" ‚Üí v√™ grid tradicional
2. Fluxo id√™ntico ao anterior (sem mudan√ßas)

#### üìä **ESTAT√çSTICAS IMPLEMENTADAS:**

**Dashboard de Aloca√ß√£o**
- ‚úÖ Total de produtos aguardando aloca√ß√£o
- ‚úÖ N√∫mero de grupos/lotes
- ‚úÖ Contagem de lotes com produtos urgentes
- ‚úÖ Peso total por lote

**Alertas Inteligentes**
- ‚úÖ Produtos vencendo em 7 dias destacados
- ‚úÖ Lotes com produtos urgentes priorizados visualmente
- ‚úÖ Contadores de urg√™ncia por lote

#### üöÄ **PR√ìXIMOS PASSOS:**
- Testes E2E da funcionalidade de aloca√ß√£o agrupada
- Valida√ß√µes adicionais (se necess√°rio)
- Testes de regress√£o completos

---

## ‚úÖ CRIT√âRIOS DE ACEITA√á√ÉO

### Funcional
- ‚úÖ Admin pode cadastrar m√∫ltiplos produtos com cliente comum
- ‚úÖ Produtos aparecem agrupados na p√°gina de aloca√ß√£o
- ‚úÖ Operador pode alocar produtos individualmente dentro dos grupos
- ‚úÖ Formul√°rio individual continua funcionando normalmente
- ‚úÖ Zero quebra de funcionalidades existentes

### T√©cnico
- ‚úÖ Performance adequada (< 2s para cadastro de 50 produtos)
- ‚úÖ Valida√ß√µes robustas backend e frontend
- ‚úÖ Testes de regress√£o 100% passando
- ‚úÖ C√≥digo revisado pelo Zen
- ‚úÖ Documenta√ß√£o atualizada

### UX
- ‚úÖ Interface intuitiva para adicionar/remover produtos
- ‚úÖ Feedback visual claro de status e erros
- ‚úÖ Agrupamento visual claro na p√°gina de aloca√ß√£o
- ‚úÖ Transi√ß√µes suaves e loading states

---

**üìå LEMBRETE**: Este arquivo deve ser atualizado a cada implementa√ß√£o significativa e sempre referenciado antes de tomar decis√µes t√©cnicas importantes.